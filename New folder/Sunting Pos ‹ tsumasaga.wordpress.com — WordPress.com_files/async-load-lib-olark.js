webpackJsonp([0x88fdc4e7970e2,0xf5d7f47f5cb74],{0x62509a33c5c9:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=a(6632847112607300),i=n(o),r=a(4675954658966525),l=n(r),u=a(4883949902648912),s=n(u),c=a(7572476330282672),d=n(c),f=a(8478035041892969),p=n(f),A=a(0xf2ce944f0fc89),O=n(A),h=a(6183759582808303),_=n(h),E=a(640686485904272),v=n(E),b=a(5549911571722683),y=n(b),g=a(5382928525759938),R=n(g),L=a(0x4fdf707568d78),S=n(L),k=a(8057283025915989),m=(0,l.default)("calypso:olark"),x=(0,_.default)(),T=p.default.undocumented();a(5382928525759938);var C={apiId:1,eligibilityKey:"SupportChat",operatorsAvailableKey:"OlarkOperatorsAvailable",conversationStarted:!1,operatorAvailable:!1,userType:"Unknown",initialize:function(e){var t=this;m("Initializing Olark Live Chat"),this.getOlarkConfiguration().then(function(a){return t.configureOlark(a,e)}).catch(function(e){return t.handleError(e)})},handleError:function(e){e&&e.message&&"authorization_required"!==e.error&&v.default.error(e.message)},getOlarkConfiguration:function(){return new i.default(function(e,t){m("Using rest api to get olark configuration");var a=(0,s.default)("client_slug");T.getOlarkConfiguration(a,function(a,n){return a?void t(a):void e(n)})})},configureOlark:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments[1],n=x.get(),o=["api.chat.onReady","api.chat.onOperatorsAway","api.chat.onOperatorsAvailable","api.chat.onBeginConversation","api.chat.onMessageToVisitor","api.chat.onMessageToOperator","api.chat.onCommandFromOperator"],i=["api.box.onShow","api.box.onExpand","api.box.onHide","api.box.onShrink","api.chat.onMessageToVisitor"],r=["api.chat.onReady","api.chat.onBeginConversation","api.chat.onMessageToVisitor","api.chat.onMessageToOperator","api.chat.onCommandFromOperator","api.chat.onOfflineMessageToOperator"];y.default.initialize(),y.default.once("api.chat.onReady",S.default.setReady),y.default.once("api.chat.onReady",function(){return a((0,k.olarkReady)())}),y.default.on("api.chat.onOperatorsAway",S.default.setOperatorsAway),y.default.on("api.chat.onOperatorsAway",function(){return a((0,k.operatorsAway)())}),y.default.on("api.chat.onOperatorsAvailable",S.default.setOperatorsAvailable),y.default.on("api.chat.onOperatorsAvailable",function(){return a((0,k.operatorsAvailable)())}),i.forEach(this.hookExpansionEventToStoreSync.bind(this)),o.forEach(function(e){return y.default.on(e,S.default.updateDetails)}),r.forEach(function(t){return y.default.on(t,function(){setTimeout(function(){return e.updateOlarkFormatting(n.display_name,n.avatar_URL)},0)})}),m("Olark code loaded, beginning configuration"),y.default.on("api.chat.onCommandFromOperator",function(e){"end"===e.command.name&&S.default.sendNotificationToVisitor(d.default.translate("Your live chat has ended. We'll send a transcript to %(email)s.",{args:{email:n.email}}))}),this.setOlarkOptions(n,t),a((0,k.setChatAvailability)(t.availability))},updateOlarkGroupAndEligibility:function(){var e=this;this.getOlarkConfiguration().then(function(e){var t="undefined"==typeof e.isUserEligible||e.isUserEligible;S.default.setUserEligibility(t)}).catch(function(t){return e.handleError(t)})},syncStoreWithExpandedState:function(){var e=!!document.querySelector(".olrk-state-expanded");e!==R.default.get().isOlarkExpanded&&S.default.setExpanded(e)},hookExpansionEventToStoreSync:function(e){y.default.on(e,this.syncStoreWithExpandedState)},setOlarkOptions:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.group||(0,s.default)("olark").business_group_id,n="undefined"==typeof t.isUserEligible||t.isUserEligible,o=t.nickname||e.username+" | "+this.userType;m("Nickname: "+o),m("Group: "+a),S.default.setUserEligibility(n),S.default.setClosed(t.isClosed),t.locale&&S.default.setLocale(t.locale)},updateOlarkFormatting:function(e,t){var a,n,o,i,r,l,u,s,c,f,p,A=document.querySelectorAll(".hbl_pal_local_fg, .hbl_pal_remote_fg:not(.habla_conversation_notification_nickname)"),O=document.querySelectorAll(".olrk_avatar"),h={},_="//gravatar.com/avatar?s=32&d=identicon&r=PG",E=d.default.translate("staff");for(r=0;r<O.length;r++)l=O.item(r),u=l.parentElement.querySelector(".hbl_pal_remote_fg"),u&&(h[u.originalTextContent||u.textContent]=l.getAttribute("src"));for(c=0;c<A.length;c++)f=A.item(c),a=f.className.replace(/.*(habla_conversation_person\d+).*/,"$1"),p=!!f.className.match(/hbl_pal_local_fg/),s=f.textContent,n!==a?(p?f.textContent=e:f.querySelector(".staff-label")||(f.originalTextContent=f.textContent,f.textContent=f.textContent.replace(":",""),i=document.createElement("span"),i.setAttribute("class","staff-label"),i.appendChild(document.createTextNode(E)),f.appendChild(i)),f.querySelector(".gravatar")||(o=document.createElement("img"),o.setAttribute("class","gravatar"),p?o.setAttribute("src",t):o.setAttribute("src",h[s]||_),f.insertBefore(o,f.firstChild)),n=a):f.parentElement.removeChild(f)}};(0,O.default)(C),e.exports=C},0x4fdf707568d78:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(8769427305820155),i=n(o),r=a(5115717672895149),l={setUserEligibility:function(e){i.default.handleServerAction({isUserEligible:e,type:r.action.OLARK_USER_ELIGIBILITY})},setLocale:function(e){i.default.handleServerAction({locale:e,type:r.action.OLARK_LOCALE})},setReady:function(){i.default.handleServerAction({type:r.action.OLARK_READY})},setOperatorsAvailable:function(){i.default.handleServerAction({type:r.action.OLARK_OPERATORS_AVAILABLE})},setOperatorsAway:function(){i.default.handleServerAction({type:r.action.OLARK_OPERATORS_AWAY})},setClosed:function(e){i.default.handleServerAction({isSupportClosed:e,type:r.action.OLARK_SET_CLOSED})},setExpanded:function(e){i.default.handleServerAction({isOlarkExpanded:e,type:r.action.OLARK_SET_EXPANDED})},updateDetails:function(){},sendNotificationToVisitor:function(){},sendNotificationToOperator:function(){},expandBox:function(){},shrinkBox:function(){},hideBox:function(){},focusBox:function(){}};t.default=l,e.exports=t.default},5115717672895149:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.action=void 0;var o=a(0x5035497fe4bcb),i=n(o);t.action=(0,i.default)({OLARK_READY:null,OLARK_OPERATORS_AWAY:null,OLARK_OPERATORS_AVAILABLE:null,OLARK_DETAILS:null,OLARK_LOCALE:null,OLARK_USER_ELIGIBILITY:null,OLARK_SET_CLOSED:null,OLARK_SET_EXPANDED:null})},5382928525759938:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(872100829608442),i=n(o),r=a(0x512990e747cbb),l=a(5115717672895149),u={isOperatorAvailable:!1,isOlarkReady:!1,isUserEligible:!1,isOlarkExpanded:!1,isSupportClosed:!1,locale:"en",details:{}},s=(0,r.createReducerStore)(function(e,t){var a=void 0,n=t.action;switch(n.type){case l.action.OLARK_USER_ELIGIBILITY:a={isUserEligible:n.isUserEligible};break;case l.action.OLARK_LOCALE:a={locale:n.locale};break;case l.action.OLARK_READY:a={isOlarkReady:!0};break;case l.action.OLARK_OPERATORS_AWAY:a={isOperatorAvailable:!1};break;case l.action.OLARK_OPERATORS_AVAILABLE:a={isOperatorAvailable:!0};break;case l.action.OLARK_SET_EXPANDED:a={isOlarkExpanded:n.isOlarkExpanded};break;case l.action.OLARK_DETAILS:a={details:n.details};break;case l.action.OLARK_SET_CLOSED:a={isSupportClosed:n.isSupportClosed}}return a?(0,i.default)({},e,a):e},u);t.default=s,e.exports=t.default},5549911571722683:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(4675954658966525),i=n(o),r=a(0xf2ce944f0fc89),l=n(r),u=["api.box.onShow","api.box.onHide","api.box.onExpand","api.box.onShrink","api.chat.onReady","api.chat.onOperatorsAvailable","api.chat.onOperatorsAway","api.chat.onBeginConversation","api.chat.onMessageToOperator","api.chat.onMessageToVisitor","api.chat.onCommandFromOperator","api.chat.onOfflineMessageToOperator"],s=(0,i.default)("calypso:olark:events"),c={},d=!1,f=!1,p={initialize:function(){var e=this;return d?void s("Already initalized"):(d=!0,u.forEach(function(t){return e.addOlarkEventListener(t)}),void s("Initalized"))},addOlarkEventListener:function(e){s("Adding olark event listener: %s",e),c[e]||(c[e]=!0)},olarkEventListener:function(e){s("Olark event: %s",e);for(var t=arguments.length,a=Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];this.emit.apply(this,[e].concat(a))}};(0,l.default)(p),p.once("api.chat.onReady",function(){f=!0}),p.on("newListener",function(e,t){f&&"api.chat.onReady"===e&&t()}),t.default=p,e.exports=t.default},8057283025915989:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){return{type:f.OLARK_TIMEOUT}}function i(){return{type:f.OLARK_READY}}function r(){return{type:f.OLARK_OPERATORS_AVAILABLE}}function l(){return{type:f.OLARK_OPERATORS_AWAY}}function u(e){return{type:f.OLARK_SET_AVAILABILITY,availability:e}}function s(){return function(e){return e({type:f.OLARK_REQUEST}),new d.default(function(t){e(o()),t()})}}Object.defineProperty(t,"__esModule",{value:!0});var c=a(6632847112607300),d=n(c);t.olarkTimeout=o,t.olarkReady=i,t.operatorsAvailable=r,t.operatorsAway=l,t.setChatAvailability=u,t.requestOlark=s;var f=a(0xd047e5c4c63f8)}});